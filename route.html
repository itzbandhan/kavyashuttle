<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route Details - Kavya Shuttle</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link rel="shortcut icon" href="https://kavyaschool.edu.np/favicon.ico">
</head>

<body class="bg-gradient-to-br from-slate-50 to-slate-100 min-h-screen">

<header class="py-6 flex justify-center bg-white border-b border-slate-100 shadow-sm">
  <img src="https://kavyaschool.edu.np/images/Kavya-Ing.svg" class="h-12 w-auto" alt="Kavya Logo" />
</header>

<div class="max-w-4xl mx-auto px-4 pt-8">
  <a href="index.html" class="inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-white border border-slate-200 text-slate-600 hover:border-slate-400 transition-all shadow-sm font-bold group">
    <i data-lucide="arrow-left" class="w-5 h-5 group-hover:-translate-x-1 transition-transform"></i> 
    Back to Home
  </a>
</div>

<main class="max-w-4xl mx-auto px-4 py-8">
  <div id="routeBox" class="bg-white rounded-[40px] shadow-2xl p-8 sm:p-12 border border-slate-50">
    <div class="flex flex-col items-center py-12">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-[#76c044] mb-4"></div>
      <p class="text-slate-400 font-medium">Fetching details...</p>
    </div>
  </div>
</main>

<script>
fetch("index.json")
  .then(r => r.json())
  .then(data => {
    const id = new URLSearchParams(location.search).get("id");
    const r = data[id];

    if (!r) {
      document.getElementById("routeBox").innerHTML = `
        <div class="text-center py-12">
          <i data-lucide="alert-octagon" class="w-16 h-16 text-red-500 mx-auto mb-4"></i>
          <h2 class="text-2xl font-black text-slate-900 mb-2">Route Not Found</h2>
          <p class="text-slate-500 mb-6">The route ID provided does not exist in our database.</p>
          <a href="index.html" class="text-[#76c044] font-bold underline">Go Back Home</a>
        </div>
      `;
      lucide.createIcons();
      return;
    }

    // Process school contacts into clickable links
    const schoolContactsHtml = r.school_contact.split(',').map(num => {
      const trimmedNum = num.trim();
      return `<a href="tel:${trimmedNum}" class="text-slate-900 font-bold hover:text-blue-600 hover:underline transition-colors">${trimmedNum}</a>`;
    }).join('<span class="text-slate-400 mx-1">,</span>');

    document.getElementById("routeBox").innerHTML = `
      <div class="space-y-10">
        <div>
          <p class="text-slate-400 font-bold uppercase tracking-widest text-xs mb-1">
            Kavya Shuttle Service
          </p>
          <h1 class="text-4xl font-black text-slate-900">Route ${id}: <span class="text-[#76c044]">${r.route_name}</span></h1>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
          <div class="bg-slate-50 p-6 rounded-3xl border border-slate-100 flex items-center gap-4">
            <div class="w-12 h-12 bg-white text-[#76c044] rounded-2xl flex items-center justify-center shadow-sm"><i data-lucide="user"></i></div>
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase">Driver Name</p>
              <p class="text-xl font-black text-slate-800">${r.driver_name}</p>
            </div>
          </div>
          <div class="bg-slate-50 p-6 rounded-3xl border border-slate-100 flex items-center gap-4">
            <div class="w-12 h-12 bg-white text-blue-500 rounded-2xl flex items-center justify-center shadow-sm"><i data-lucide="phone"></i></div>
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase">Driver Contact</p>
              <a href="tel:${r.driver_contact}" class="text-xl font-black text-blue-600 hover:underline transition-all">
                ${r.driver_contact}
              </a>
            </div>
          </div>
        </div>

        <div class="space-y-6">
          <h2 class="text-2xl font-black text-slate-900 flex items-center gap-2">
             <i data-lucide="map-pin" class="text-red-500 w-6 h-6"></i> Scheduled Stops
          </h2>
          <div class="bg-white border-2 border-slate-50 rounded-3xl divide-y-2 divide-slate-50 overflow-hidden shadow-sm">
            ${r.pickup_locations.map((l, index) => `
              <div class="px-6 py-5 hover:bg-slate-50 transition-colors flex items-center gap-4">
                <span class="w-8 h-8 flex-shrink-0 bg-slate-100 text-slate-500 rounded-lg flex items-center justify-center font-bold text-sm">${index + 1}</span>
                <p class="text-lg font-bold text-slate-700">${l.name}</p>
              </div>
            `).join("")}
          </div>
        </div>

        <div class="pt-8 border-t border-slate-100 flex flex-col md:flex-row md:items-center justify-between gap-6">
          
          <div class="flex items-center gap-3">
            <div class="p-2 bg-slate-100 rounded-lg text-slate-500">
              <i data-lucide="building" class="w-5 h-5"></i>
            </div>
            <div>
              <p class="text-xs font-bold uppercase tracking-wider text-slate-400">School Office</p>
              <div class="text-base">${schoolContactsHtml}</div>
            </div>
          </div>

          <a href="index.html" class="w-full sm:w-auto inline-flex items-center justify-center gap-2 bg-[#76c044] hover:bg-[#68a93c] text-white px-8 py-4 rounded-2xl font-bold text-lg transition-all duration-200 shadow-lg shadow-[#76c044]/20 hover:shadow-xl hover:-translate-y-1">
            <i data-lucide="search" class="w-5 h-5"></i>
            Search Another Route
          </a>
        </div>
      </div>
    `;
    lucide.createIcons();
  })
  .catch((err) => {
    console.error(err);
    document.getElementById("routeBox").innerHTML = `
      <div class="text-center py-12 text-red-500">
        <i data-lucide="wifi-off" class="w-12 h-12 mx-auto mb-4"></i>
        <p class="font-bold">Error loading route data. Please check your connection.</p>
      </div>
    `;
    lucide.createIcons();
  });
</script>
</body>
</html>